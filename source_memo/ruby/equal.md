# 一致判定

## リファレンスでのそれぞれの説明

### equal?

- 二つのオブジェクトが同一のものかどうか調べる時に使用します。このメソッドを再定義してはいけません。
- お互いのObject#object_idが一致するかどうかを調べます。

### eql?

- オブジェクトと other が等しければ真を返します。Hash で二つのキーが等しいかどうかを判定するのに使われます。
- このメソッドは各クラスの性質に合わせて再定義すべきです。多くの場合、 == と同様に同値性の判定をするように再定義されていますが、適切にキー判定ができるようにより厳しくなっている場合もあります。
- デフォルトでは equal? と同じオブジェクトの同一性判定になっています。

### ==

- 多くの場合、オブジェクトの内容が等しければ真を返すように（同値性を判定するように）再定義されることが期待されています。
- デフォルトでは equal? と同じオブジェクトの同一性判定になっています。

### ===

- このメソッドは case 式での振る舞いを考慮して、各クラスの性質に合わせて再定義すべきです。
- デフォルトでは内部で Object#== を呼び出します。

### まとめ

- `equal?`と`==`と`eql?`は同値性
- `euqal?` はobject_idの比較であり、再定義してはいけない
- `eql?`はHashのキー判定に使うため`==`よりも厳しくするケースも
  - どちらもデフォルトは`euqal?`
- `===`はcaseを考慮してクラスの性質に合わせて広げて判断
  - デフォルトは`==`

```ruby
# イメージしやすいようにコードにして整理してみる

def equal?(other)
  object_id == other.object_id # ここでの==はただ一緒かなだけで意味はない
end

def ===(other)
  ==(other)
end

def eql?(other)
  equal?(other)
end

def ==(other)
  equal?(other)
end
```

## 判断される箇所整理

- equal?
- eql?
  - Array#uniq, Array#uniq!
- ==
  - Array#include?
  - Hash#key?
  - Hash#value?
- ===
  - case文
